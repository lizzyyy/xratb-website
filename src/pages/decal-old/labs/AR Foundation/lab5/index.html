<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/decal/assets/css/just-the-docs-default.css"> <script src="/decal/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>AR Foundation Lab 5: Image Tracking, Health Bar | Extended Reality Development</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="AR Foundation Lab 5: Image Tracking, Health Bar" /><meta property="og:locale" content="en_US" /><meta name="description" content="Extended Reality Development DeCal" /><meta property="og:description" content="Extended Reality Development DeCal" /><link rel="canonical" href="http://localhost:4000/decal/labs/AR%20Foundation/lab5/" /><meta property="og:url" content="http://localhost:4000/decal/labs/AR%20Foundation/lab5/" /><meta property="og:site_name" content="Extended Reality Development" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="AR Foundation Lab 5: Image Tracking, Health Bar" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Extended Reality Development DeCal","headline":"AR Foundation Lab 5: Image Tracking, Health Bar","url":"http://localhost:4000/decal/labs/AR%20Foundation/lab5/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="/decal/" class="site-title lh-tight"> Extended Reality Development </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/decal/" class="nav-list-link">Home / Announcements</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Homework category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/homework/" class="nav-list-link">Homework</a><ul class="nav-list "><li class="nav-list-item "><a href="/decal/homework/hw1/" class="nav-list-link">Homework 1: The Rube Goldberg Ball Machine</a><li class="nav-list-item "><a href="/decal/homework/hw2/" class="nav-list-link">Homework 2: Music Visualizer</a><li class="nav-list-item "><a href="/decal/homework/hw3/" class="nav-list-link">Homework 3: Fractal Generation</a><li class="nav-list-item "><a href="/decal/homework/hw4/" class="nav-list-link">Homework 4: Pong</a><li class="nav-list-item "><a href="/decal/homework/hw5/" class="nav-list-link">Homework 5: Collisions, Raycasting, and Triggers</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Labs category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/labs/" class="nav-list-link">Labs</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Oculus category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/labs/Oculus/" class="nav-list-link">Oculus</a><ul class="nav-list"><li class="nav-list-item "> <a href="/decal/labs/Oculus/lab1/" class="nav-list-link">Oculus Lab 1: Building the Environment</a><li class="nav-list-item "> <a href="/decal/labs/Oculus/lab2/" class="nav-list-link">Oculus Lab 2: Building the Gun</a><li class="nav-list-item "> <a href="/decal/labs/Oculus/lab3/" class="nav-list-link">Oculus Lab 3: The Monster</a><li class="nav-list-item "> <a href="/decal/labs/Oculus/lab4/" class="nav-list-link">Oculus Lab 4: Putting It All Together</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in AR Foundation category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/labs/AR%20Foundation/" class="nav-list-link">AR Foundation</a><ul class="nav-list"><li class="nav-list-item "> <a href="/decal/labs/AR%20Foundation/lab1/" class="nav-list-link">AR Foundation Lab 1: Project Setup / Building the Environment</a><li class="nav-list-item "> <a href="/decal/labs/AR%20Foundation/lab2/" class="nav-list-link">AR Foundation Lab 2: Building the Gun</a><li class="nav-list-item "> <a href="/decal/labs/AR%20Foundation/lab3/" class="nav-list-link">AR Foundation Lab 3: The Monster</a><li class="nav-list-item "> <a href="/decal/labs/AR%20Foundation/lab4/" class="nav-list-link">AR Foundation Lab 4: Putting It All Together</a><li class="nav-list-item active"> <a href="/decal/labs/AR%20Foundation/lab5/" class="nav-list-link active">AR Foundation Lab 5: Image Tracking, Health Bar</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in HTC Vive category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/labs/HTC%20Vive/" class="nav-list-link">HTC Vive</a><ul class="nav-list"><li class="nav-list-item "> <a href="/decal/labs/HTC%20Vive/lab1/" class="nav-list-link">Vive Lab 1: Building the Environment</a><li class="nav-list-item "> <a href="/decal/labs/HTC%20Vive/lab2/" class="nav-list-link">Vive Lab 2: Creating the Gun</a><li class="nav-list-item "> <a href="/decal/labs/HTC%20Vive/lab3/" class="nav-list-link">Vive Lab 3: The Monster</a><li class="nav-list-item "> <a href="/decal/labs/HTC%20Vive/lab4/" class="nav-list-link">Vive Lab 4: Putting It All Together</a></ul></ul><li class="nav-list-item"><a href="/decal/lectures/" class="nav-list-link">Lectures</a><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Final Project category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/decal/final-project/" class="nav-list-link">Final Project</a><ul class="nav-list "><li class="nav-list-item "><a href="/decal/final-project/project-resources/" class="nav-list-link">Project Resources</a></ul><li class="nav-list-item"><a href="/decal/extra-resources/" class="nav-list-link">Extra Resources</a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div></div></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/decal/labs/">Labs</a><li class="breadcrumb-nav-list-item"><a href="/decal/labs/AR%20Foundation/">AR Foundation</a><li class="breadcrumb-nav-list-item"><span>AR Foundation Lab 5: Image Tracking, Health Bar</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="no_toc" id="ar-foundation-lab-5-image-tracking-health-bar"> <a href="#ar-foundation-lab-5-image-tracking-health-bar" class="anchor-heading" aria-labelledby="ar-foundation-lab-5-image-tracking-health-bar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AR Foundation Lab 5: Image Tracking, Health Bar</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ul id="markdown-toc"><li><a href="#health-bar" id="markdown-toc-health-bar">Health Bar</a><li><a href="#image-tracking" id="markdown-toc-image-tracking">Image Tracking</a><li><a href="#final-remarks" id="markdown-toc-final-remarks">Final Remarks</a></ul><hr /><p>In this lab, we’ll focus on image tracking, particularly tracking an object in the physical space so that a virtual object is overlayed on it. We’ll be changing the gun from being static on screen to tracking the gun prefab on the back of a playing card. We will also be adding some more UI elements to the app as well.</p><p>Extra UI elements to be added:</p><ul><li>Player health bar that reduces when hit.</ul><h1 id="health-bar"> <a href="#health-bar" class="anchor-heading" aria-labelledby="health-bar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Health Bar</h1><p>Let’s start off with the health bar.</p><p>Download this bar <a href="https://drive.google.com/file/d/1QeEUII5GmR9BPEpLx9a2GrYDhcDINe0e/view"><strong>here</strong></a>. Add it to the textures folder in Unity, like you did with the image that you tracked in the previous section.</p><p>Change the <strong>Texture Type</strong> to Sprite (2D and UI).</p><p><img src="/decal/assets/images/ar%20foundation/lab5/bar%20inspector.png" alt="image" /></p><p>In the textures folder, the Bar should look like this now:</p><p><img src="/decal/assets/images/ar%20foundation/lab5/bar.png" alt="image" /></p><p>Create a new <strong>UI &gt; Image</strong> object in the Canvas and rename it to “Border”. Take the bar sprite and drag it into the Source Image slot, and click Set Native Size to avoid any stretching.</p><p>Then, create an empty game object in Canvas called “Health Bar” and change its width and height to 52 and 9 respectively, so that it matches the size of the border. This way, we can take our border and set it as a child of Health Bar. We will have the border and the fill of the health bar inside of this Health Bar object.</p><p>To add the fill of the health bar, we <strong>right click on Health Bar &gt; UI &gt; Image</strong> and rename it to “Fill”. Make sure that the Fill is above Border so that the fill shows underneath the border. Change the image color to red. In the Rect Transform anchor presets, select the bottom right option <strong>while also holding down alt</strong> so that it sets the position as well.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/rect%20transform%20fill_0.png" alt="image" /></p><p>In the Border do the same thing, but DON’T hold down alt this time; we only want to set the anchors for the border. Now when you scale the Health Bar game object, the fill and the border scale with it.</p><p>In the Health Bar game object, select the anchor preset, <strong>while holding alt</strong>, that sets the health bar to the top left. We also scaled the health bar so that it would be bigger.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/health%20transform.png" alt="image" /></p><p>Now that everything is in place, we can implement the health going down! We are going to use a slider component to decrease the fill of the health bar.</p><p>In the Health Bar game object, add a Slider component. Uncheck Interactable, set Transition to None, set Navigation to None. Drag in the Fill from the Health Bar to the <strong>Fill Rect</strong> area, and set the <strong>Max Value</strong> to 100.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/slider.png" alt="image" /></p><p>Try dragging the value slider left and right. You should see the red bar go up and down as you drag it! We are going to write a script to decrease the slider value as the player gets hit.</p><p>Create a script and import the UnityEngine.UI library. In this script we only need to reference the slider and write a function that sets the slider’s value.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public Slider slider;

public void SetHealth(int health)
{
    slider.value = health;
}
</code></pre></div></div><p>Every time the monster attacks the player, the player loses health; we want that new health to be reflected in the health bar/slider value. We are leaving this implementation as an exercise to the reader. Think about what you need to add to the Attack() function in Monster.cs so that the slider.value matches the player’s health value. You might need to implement a getter function in Player.cs.</p><p>When this is all implemented, try getting hit by the monsters! The health bar will go down as you get hit.</p><h1 id="image-tracking"> <a href="#image-tracking" class="anchor-heading" aria-labelledby="image-tracking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Image Tracking</h1><p>First off, in the AR Session Origin, add a new component <strong>AR Tracked Image Manager</strong>.</p><p>For our tracked image prefab, we want to use the gun, so we need to make the gun into a prefab first.</p><p>Go to <strong>Assets &gt; Prefabs</strong> and drag the Gun object from the hierarchy into the project view in the prefabs folder to create a gun prefab.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/Gun%20prefab.png" alt="image" /></p><p>In the hierarchy view, the gun will now have the blue box icon next to it, indicating that it is a prefab.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/gun%20prefab%20hierarchy.png" alt="image" /></p><p>We can delete the Gun game object from the hierarchy now. Drag the Gun prefab into <strong>Tracked Image Prefab</strong> in the AR Tracked Image Manager component.</p><p>Now we need to create a reference library for the images we will be tracking. For now, since only the gun will be tracked, we only need one image. For my image, I used the back of a playing card; <strong>the more complex the image is, the better it will be for tracking</strong>. The gun may be a little wonky though, since tracking a moving image while also moving the camera around makes it hard for the camera to properly track. In your final projects, if you are using image tracking, then it is most consistent with images and objects that are static/non-moving.</p><p>Take a picture of your card and add it to the assets &gt; textures folder.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/texture%20card.png" alt="image" /></p><p>Now, to create a reference library, we go back to the prefabs folder. <strong>Right click in the prefabs folder &gt; Create &gt; XR &gt; Reference Image Library</strong>.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/reference%20lib.png" alt="image" /></p><p>In the ReferenceImageLibrary, click Add Image and select the card. Specify the size as close as possible to the size of the object in the real world.</p><p><img src="/decal/assets/images/ar%20foundation/lab5/card%20size.png" alt="image" /></p><p>Back to the AR Session Origin, drag the ReferenceImageLibrary into the <strong>Reference Library</strong> variable under the AR Tracked Image Manager component. Change the <strong>Max Number of Moving Images</strong> to 1.</p><p>Try running the app on your device now. The gun should appear when you bring up the card now! It should look something like this:</p><p><img src="/decal/assets/images/ar%20foundation/lab5/screenshot.jpg" alt="image" /></p><p>One last thing. You may notice now that the button doesn’t work to fire the gun anymore. That’s because the button used to track the GameObject Gun, but now we have a Prefab Gun. Recall in the previous lab that prefabs cannot access or be accessed any gameobjects from a specific scene. This is because prefabs have to work across all scenes, and even across different projects. For that reason, they cannot use anything that’s tied to a single scene. Moreover, the Gun gameobject is now being created at runtime instead of already being in the scene, so the fire button component has no way to access the game object before runtime. There are ways around this, but for simplicity’s sake, we will just be going back to what we did in Lab 2 to fire - just tapping on the screen (even though we just created the fire button UI in the last lab lol).</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void Update()
    {
        if (Input.touchCount &gt; 0)
        {
            Touch touch = Input.GetTouch(0);
            if (touch.phase == TouchPhase.Began)
            {
                Fire();
            }
        }
    }
</code></pre></div></div><p>The gun should be tracked by the card now and fire when you tap on the screen!</p><p><em>This marks the end of lab 5!</em></p><h1 id="final-remarks"> <a href="#final-remarks" class="anchor-heading" aria-labelledby="final-remarks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Final Remarks</h1><p>Congratulations! You now have a fully implemented game that you’ve created for your device in AR. There are still a ton of things that could be added and improved on, of course, and we encourage you to add stuff in your own time. We hope that this lab series gave you enough knowledge and familiarity with Unity/AR Foundation to kickstart your own final projects.</p></div></div></div>
